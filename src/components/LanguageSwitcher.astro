---
import type { Lang } from '../i18n/utils';
import { getAlternateLang, getLocalizedPath, useTranslations } from '../i18n/utils';

interface Props {
  lang: Lang;
  currentPath?: string;
}

const { lang, currentPath } = Astro.props;
const t = useTranslations(lang);
const altLang = getAlternateLang(lang);

// If currentPath is provided (e.g. on sub-pages), swap the lang prefix
// Otherwise fall back to the homepage in the alternate language
const altPath = currentPath
  ? currentPath.replace(`/${lang}/`, `/${altLang}/`)
  : getLocalizedPath(altLang);
---

<a href={altPath} class="lang-switch" title={t.lang.switchTitle}>
  {t.lang.switchLabel}
</a>

<style>
  .lang-switch {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.25rem 0.625rem;
    font-size: var(--fs-sm);
    font-weight: var(--fw-semibold);
    color: var(--color-text-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius);
    transition: color var(--transition-fast), border-color var(--transition-fast);
  }

  .lang-switch:hover {
    color: var(--color-accent);
    border-color: var(--color-accent);
  }
</style>
